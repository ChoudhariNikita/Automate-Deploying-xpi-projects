# Deployment Automation PoC

This repository contains a Proof of Concept (PoC) for automating the deployment of XPI projects using Python. The script reads project details from a JSON file, uploads the required files to a server, and logs the deployment status.

## File Descriptions
- **`.env`**: Refer to the `.env.example` file and create your own `.env` file with the required environment variables.
- **`.env.example`**: A template file to help you set up your `.env` file.
- **`.gitignore`**: Specifies files to be ignored by Git, such as `.env`, `projects.json`, and `deployment_log.txt`.
- **`Automate.py`**: The main script that handles the deployment process. It reads project details from `projects.json` and uploads them to the server.
- **`generateJson.py`**: A helper script to generate the `projects.json` file by scanning a directory for project folders.
- **`projects.json`**: Contains details of the projects to be deployed, such as project name, ZIP file path, context file path, and hash. **This file is generated by `generateJson.py`.**
- **`deployment_log.txt`**: Logs the deployment status, including start time, end time, duration, and status (e.g., SUCCESS, TIMEOUT).
- **`requirements.txt`**: Lists the Python dependencies required for the scripts.

## Steps to Use

1. **Clone the Repository**  
Clone this repository to your local machine.

```bash
git clone https://github.com/ChoudhariNikita/Automate-Deploying-xpi-projects.git
cd Automate-Deploying-xpi-projects
```

2. **Install Dependencies**  
   Install the required Python packages using `pip`.

   ```bash
   pip install -r requirements.txt
   ```

3. **Set Up Environment Variables**  
   - Copy `.env.example` to `.env`.
   - Update the `.env` file with your actual values:
     - `ACCESS_TOKEN`: Your API access token.
     - `PROJECTS_DIR`: The directory containing your project folders.
     - `BASE_URL`: The API endpoint for deployment.
     - `CUSTOMER`: Your customer name.
     - `ENVIRONMENT`: The target environment.

   Example `.env` file:
   ```env
   ACCESS_TOKEN=your_actual_access_token
   PROJECTS_DIR=C:\path\to\your\projects
   BASE_URL=https://your-api-endpoint.com/deploy
   CUSTOMER=your_customer_name
   ENVIRONMENT=your_environment
   ```

4. **Generate `projects.json`**  
   Run the `generateJson.py` script to scan the `PROJECTS_DIR` and generate the `projects.json` file.

   ```bash
   python generateJson.py
   ```

   - Ensure the `PROJECTS_DIR` contains valid project folders.
   - The script will skip folders with prefixes listed in the `ignore_prefixes` variable.

5. **Run the Deployment Script**  
   Execute the Automate.py script to start the deployment process.

   ```bash
   python Automate.py
   ```

   - The script will read project details from projects.json, upload the required files, and log the results in deployment_log.txt.

6. **Check Logs**  
   Review the deployment_log.txt file for deployment status and any errors.

## Notes

- **Changes Needed**:
  - Update .env with your actual values.
  - Modify the `ignore_prefixes` list in generateJson.py if you want to exclude specific project folders.
  - Adjust `WAIT_TIME` and `TIMEOUT_DURATION` in Automate.py if needed.

- **Error Handling**:
  - If a project fails to deploy, the script retries once. If it fails again, the error is logged in deployment_log.txt.

- **Dependencies**:
  - Ensure all dependencies listed in requirements.txt are installed.

## Example Workflow

1. Set up .env with your values.
2. Run generateJson.py to create projects.json.
3. Execute Automate.py to deploy projects.
4. Check deployment_log.txt for results.

## License

This project is for demonstration purposes only. Use at your own risk.